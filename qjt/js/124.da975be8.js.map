{"version":3,"file":"js/124.da975be8.js","mappings":"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","sources":["webpack://qjt/./src/views/EditPage.vue","webpack://qjt/./src/views/Viewer.vue","webpack://qjt/./src/panorama/PanoramaRenderer.js","webpack://qjt/src/views/Viewer.vue","webpack://qjt/./src/views/Viewer.vue?09b2","webpack://qjt/./src/views/Viewer.vue?7c8e","webpack://qjt/src/views/EditPage.vue","webpack://qjt/./src/views/EditPage.vue?3bde","webpack://qjt/./src/views/EditPage.vue?e29c"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"home\"},[_c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"image-select\"},[_c('div',{staticClass:\"img-list\"},_vm._l((_vm.imageUrlList),function(i){return _c('div',{staticClass:\"img-item\",class:{ active:_vm.currentImgId==i.id },on:{\"click\":function($event){return _vm.imgClick(i.id,i.imageURL)}}},[_c('img',{staticClass:\"img\",attrs:{\"src\":i.imageURL}}),_c('div',{staticClass:\"upload-name\"},[_vm._v(_vm._s(i.name))])])}),0),_c('div',{staticClass:\"upload\",on:{\"click\":function($event){return _vm.$refs.fileUpload.click();}}},[_c('img',{staticClass:\"upload-img\",attrs:{\"src\":require(\"../assets/img/addImg.png\")}}),_c('div',{staticClass:\"upload-name\"},[_vm._v(\"上传图片\")]),_c('input',{ref:\"fileUpload\",staticStyle:{\"display\":\"none\"},attrs:{\"accept\":\"image/*\",\"type\":\"file\"},on:{\"change\":function($event){return _vm.uploadFileChange()}}})])]),_c('div',{staticClass:\"center\"},[_c('div',{staticClass:\"img-preview\"},[_c('Viewer',{ref:\"viewImage\",attrs:{\"hotSpots\":_vm.currentHotSpots,\"autoRotate\":_vm.defaultConfig.autoRotate}})],1)]),_c('div',{staticClass:\"right-attribute\"},[_c('el-form',{attrs:{\"label-position\":\"top\",\"label-width\":\"80px\",\"model\":_vm.defaultConfig}},[_c('el-form-item',[_c('el-switch',{attrs:{\"disabled\":!_vm.currentImgId,\"active-text\":\"自动旋转\"},model:{value:(_vm.defaultConfig.autoRotate),callback:function ($$v) {_vm.$set(_vm.defaultConfig, \"autoRotate\", $$v)},expression:\"defaultConfig.autoRotate\"}})],1)],1),_c('el-button',{attrs:{\"disabled\":!_vm.currentImgId,\"size\":\"mini\",\"round\":\"\"},on:{\"click\":function($event){return _vm.addHotSpot(_vm.currentImgId)}}},[_vm._v(\"添加热点\")]),_vm._l((_vm.currentHotSpots),function(item){return _c('div',[_c('el-input',{attrs:{\"placeholder\":\"请输入内容\"},model:{value:(item.text),callback:function ($$v) {_vm.$set(item, \"text\", $$v)},expression:\"item.text\"}})],1)})],2)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"home\"},[_c('div',{ref:\"container\",staticClass:\"pnlm-container\",attrs:{\"id\":\"container\"}},[_c('div',{ref:\"uiControls\",staticClass:\"pnlm-ui\"},[_c('div',{ref:\"dragControl\",staticClass:\"pnlm-dragfix\"}),_vm._l((_vm.getHotSpots),function(item){return _c('div',{ref:item.id,refInFor:true,staticClass:\"hotspot-base\",on:{\"mousedown\":function($event){return _vm.hotspotDown($event, item)},\"mouseup\":function($event){return _vm.hotspotUp($event, item)},\"mousemove\":function($event){return _vm.hotspotMove($event, item)}}},[_c('div',{staticClass:\"tooltip-container\"},[_c('div',{staticClass:\"tooltip\"},[_c('img',{attrs:{\"src\":require(\"../assets/img/position.png\")}}),_c('div',{staticClass:\"tooltip-text\"},[_vm._v(_vm._s(item.text))])])])])}),_c('div',{ref:\"compass\",staticClass:\"pnlm-compass\"})],2)])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","let v = [\r\n    'attribute vec2 a_texCoord;',\r\n    'varying vec2 v_texCoord;',\r\n    'void main() {',\r\n    'gl_Position = vec4(a_texCoord, 0.0, 1.0);',\r\n    'v_texCoord = a_texCoord;',\r\n    '}'\r\n].join('');\r\nlet fragEquiCubeBase = [\r\n    'precision highp float;',\r\n    'uniform float u_aspectRatio;',\r\n    'uniform float u_psi;',\r\n    'uniform float u_theta;',\r\n    'uniform float u_f;',\r\n    'uniform float u_h;',\r\n    'uniform float u_v;',\r\n    'uniform float u_vo;',\r\n    'uniform float u_rot;',\r\n    'const float PI = 3.14159265358979323846264;',\r\n    'uniform sampler2D u_image0;',\r\n    'uniform sampler2D u_image1;',\r\n    'uniform bool u_splitImage;',\r\n    'uniform samplerCube u_imageCube;',\r\n    'varying vec2 v_texCoord;',\r\n    'uniform vec4 u_backgroundColor;',\r\n    'void main() {',\r\n    'float x = v_texCoord.x * u_aspectRatio;',\r\n    'float y = v_texCoord.y;',\r\n    'float sinrot = sin(u_rot);',\r\n    'float cosrot = cos(u_rot);',\r\n    'float rot_x = x * cosrot - y * sinrot;',\r\n    'float rot_y = x * sinrot + y * cosrot;',\r\n    'float sintheta = sin(u_theta);',\r\n    'float costheta = cos(u_theta);',\r\n    'float a = u_f * costheta - rot_y * sintheta;',\r\n    'float root = sqrt(rot_x * rot_x + a * a);',\r\n    'float lambda = atan(rot_x / root, a / root) + u_psi;',\r\n    'float phi = atan((rot_y * costheta + u_f * sintheta) / root);',\r\n].join('\\n');\r\nlet fragCube = fragEquiCubeBase + [\r\n    'float cosphi = cos(phi);',\r\n    'gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));',\r\n    '}'\r\n].join('\\n');\r\nlet fragEquirectangular = fragEquiCubeBase + [\r\n    'lambda = mod(lambda + PI, PI * 2.0) - PI;',\r\n    'vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));',\r\n    'if(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)',\r\n    'gl_FragColor = u_backgroundColor;',\r\n    'else {',\r\n    'if(u_splitImage) {',\r\n    'if(coord.x < 0.0)',\r\n    'gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / u_h, (-coord.y + u_v + u_vo) / (u_v * 2.0)));',\r\n    'else',\r\n    'gl_FragColor = texture2D(u_image1, vec2((coord.x + u_h) / u_h - 1.0, (-coord.y + u_v + u_vo) / (u_v * 2.0)));',\r\n    '} else {',\r\n    'gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));',\r\n    '}',\r\n    '}',\r\n    '}'\r\n].join('\\n');\r\n/**\r\n * 创建渲染器renderer.\r\n * @param {HTMLElement} container - 渲染容器DOM元素\r\n */\r\nexport default function PanoramaRenderer(container) {\r\n    let canvas;\r\n    if (container) {\r\n        canvas = document.createElement('canvas');\r\n        canvas.style.width = canvas.style.height = '100%';\r\n        container.appendChild(canvas);\r\n    }\r\n    let program, gl, vs, fs;\r\n    let previewProgram, previewVs, previewFs;\r\n    let vtmps;\r\n    let pose;\r\n    let image, imageType;\r\n    let texCoordBuffer, cubeVertBuf, cubeVertTexCoordBuf, cubeVertIndBuf;\r\n    let globalParams;\r\n    /**\r\n     * 初始化renderer.\r\n     * @memberof PanoramaRenderer\r\n     * @instance\r\n     * @param {Image|Array|Object} image - 输入图片; 格式根据`imageType`判断.\r\n     `equirectangular`：一张图片；\r\n     `cubemap`：按顺序排列的立方体面的图像数组[+z, +x, -z, -x, +y, -y]；\r\n     * @param {string} imageType - 图片的类型: `equirectangular`, `cubemap`\r\n     * @param {function} callback - 加载回调函数.\r\n     * @param {Object} [params] - 其他配置参数(`horizonPitchRadian`图像地平线的俯仰弧度, `horizonRollRadian`图像地平线的俯仰弧度, `backgroundColor`).\r\n     */\r\n    this.init = function (_image, _imageType, callback, params) {\r\n        // haov - 初始水平视角弧度（弧度 = 角度 ×（PI/180））默认360\r\n        // vaov - 初始垂直视角弧度（弧度 = 角度 ×（PI/180））默认180\r\n        // voffset - 初始垂直偏移角弧度（弧度 = 角度 ×（PI/180））默认0\r\n        let haov = 360* Math.PI / 180, vaov = 180* Math.PI / 180, voffset = 0 * Math.PI / 180;\r\n        if (_imageType === undefined) {\r\n            _imageType = 'equirectangular';\r\n        }\r\n        if (_imageType != 'equirectangular' && _imageType != 'cubemap') {\r\n            throw {type: '配置错误！'};\r\n        }\r\n        imageType = _imageType;\r\n        image = _image;\r\n        globalParams = params || {};\r\n        if (program) {\r\n            if (vs) {\r\n                gl.detachShader(program, vs);\r\n                gl.deleteShader(vs);\r\n            }\r\n            if (fs) {\r\n                gl.detachShader(program, fs);\r\n                gl.deleteShader(fs);\r\n            }\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n            if (program.texture)\r\n                gl.deleteTexture(program.texture);\r\n            gl.deleteProgram(program);\r\n            program = undefined;\r\n        }\r\n        if (previewProgram) {\r\n            if (previewVs) {\r\n                gl.detachShader(previewProgram, previewVs);\r\n                gl.deleteShader(previewVs);\r\n            }\r\n            if (previewFs) {\r\n                gl.detachShader(previewProgram, previewFs);\r\n                gl.deleteShader(previewFs);\r\n            }\r\n            gl.deleteProgram(previewProgram);\r\n            previewProgram = undefined;\r\n        }\r\n        pose = undefined;\r\n\r\n        let s;\r\n        let faceMissing = false;\r\n        let cubeImgWidth;\r\n        if (imageType == 'cubemap') {\r\n            for (s = 0; s < 6; s++) {\r\n                if (image[s].width > 0) {\r\n                    if (cubeImgWidth === undefined){\r\n                        cubeImgWidth = image[s].width;\r\n                    }\r\n                    if (cubeImgWidth != image[s].width){\r\n                        console.log('立方体面具有不一致的宽度: ' + cubeImgWidth + ' vs. ' + image[s].width);\r\n                    }\r\n                } else{\r\n                    faceMissing = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        function fillMissingFaces(imgSize) {\r\n            if (faceMissing) {\r\n                let nbytes = imgSize * imgSize * 4;\r\n                let imageArray = new Uint8ClampedArray(nbytes);\r\n                let rgb = params&&params.backgroundColor ? params.backgroundColor : [0, 0, 0];\r\n                rgb[0] *= 255;\r\n                rgb[1] *= 255;\r\n                rgb[2] *= 255;\r\n                for (let i = 0; i < nbytes; i++) {\r\n                    imageArray[i++] = rgb[0];\r\n                    imageArray[i++] = rgb[1];\r\n                    imageArray[i++] = rgb[2];\r\n                }\r\n                let backgroundSquare = new ImageData(imageArray, imgSize, imgSize);\r\n                for (s = 0; s < 6; s++) {\r\n                    if (image[s].width == 0)\r\n                        image[s] = backgroundSquare;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (!(imageType == 'cubemap' && (cubeImgWidth & (cubeImgWidth - 1)) !== 0 && (navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/) || navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/) || navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/) || navigator.userAgent.match(/Trident.*rv[ :]*11\\./)))) {\r\n            if (!gl){\r\n                gl = canvas.getContext('experimental-webgl', {alpha: false, depth: false});\r\n            }\r\n            if (gl && gl.getError() == 1286){\r\n                handleWebGLError1286();\r\n            }\r\n        }\r\n        if (!gl) {\r\n            throw {type: 'no WebGL support detected!'};\r\n        }\r\n        if (imageType == 'cubemap'){\r\n            fillMissingFaces(cubeImgWidth);\r\n        }\r\n        if (image.basePath) {\r\n            image.fullpath = image.basePath + image.path;\r\n        } else {\r\n            image.fullpath = image.path;\r\n        }\r\n        image.invTileResolution = 1 / image.tileResolution;\r\n        let vertices = createCube();\r\n        vtmps = [];\r\n        for (s = 0; s < 6; s++) {\r\n            vtmps[s] = vertices.slice(s * 12, s * 12 + 12);\r\n            vertices = createCube();\r\n        }\r\n        let maxWidth = 0;\r\n        if (imageType == 'equirectangular') {\r\n            maxWidth = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n            if (Math.max(image.width / 2, image.height) > maxWidth) {\r\n                throw {type: `图片太大${image.width}px 宽, 设备最大支持${maxWidth * 2}px.`, width: image.width, maxWidth: maxWidth * 2};\r\n            }\r\n        } else if (imageType == 'cubemap') {\r\n            if (cubeImgWidth > gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE)) {\r\n                throw {type: `图片太大${cubeImgWidth}px 宽, 设备最大支持${maxWidth * 2}px.`, width: cubeImgWidth, maxWidth: maxWidth};\r\n            }\r\n        }\r\n        if (params) {\r\n            let horizonPitchRadian = isNaN(params.horizonPitchRadian) ? 0 : Number(params.horizonPitchRadian), horizonRollRadian = isNaN(params.horizonRollRadian) ? 0 : Number(params.horizonRollRadian);\r\n            if (horizonPitchRadian != 0 || horizonRollRadian != 0){\r\n                pose = [horizonPitchRadian, horizonRollRadian];\r\n            }\r\n        }\r\n        let glBindType = gl.TEXTURE_2D;\r\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n        if (gl.getShaderPrecisionFormat) {\r\n            let precision = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);\r\n            if (precision && precision.precision < 1) {\r\n                fragEquiCubeBase = fragEquiCubeBase.replace('highp', 'mediump');\r\n            }\r\n        }\r\n        vs = gl.createShader(gl.VERTEX_SHADER);\r\n        let vertexSrc = v;\r\n        gl.shaderSource(vs, vertexSrc);\r\n        gl.compileShader(vs);\r\n        fs = gl.createShader(gl.FRAGMENT_SHADER);\r\n        let fragmentSrc = fragEquirectangular;\r\n        if (imageType == 'cubemap') {\r\n            glBindType = gl.TEXTURE_CUBE_MAP;\r\n            fragmentSrc = fragCube;\r\n        }\r\n        gl.shaderSource(fs, fragmentSrc);\r\n        gl.compileShader(fs);\r\n        program = gl.createProgram();\r\n        gl.attachShader(program, vs);\r\n        gl.attachShader(program, fs);\r\n        gl.linkProgram(program);\r\n        if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)){\r\n            console.log(gl.getShaderInfoLog(vs));\r\n        }\r\n        if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)){\r\n            console.log(gl.getShaderInfoLog(fs));\r\n        }\r\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)){\r\n            console.log(gl.getProgramInfoLog(program));\r\n        }\r\n        gl.useProgram(program);\r\n        program.drawInProgress = false;\r\n        let color = params&&params.backgroundColor ? params.backgroundColor : [0, 0, 0];\r\n        gl.clearColor(color[0], color[1], color[2], 1.0);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n        program.texCoordLocation = gl.getAttribLocation(program, 'a_texCoord');\r\n        gl.enableVertexAttribArray(program.texCoordLocation);\r\n        if (!texCoordBuffer){\r\n            texCoordBuffer = gl.createBuffer();\r\n        }\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, texCoordBuffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, 1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1]), gl.STATIC_DRAW);\r\n        gl.vertexAttribPointer(program.texCoordLocation, 2, gl.FLOAT, false, 0, 0);\r\n        program.aspectRatio = gl.getUniformLocation(program, 'u_aspectRatio');\r\n        gl.uniform1f(program.aspectRatio, gl.drawingBufferWidth / gl.drawingBufferHeight);\r\n        program.psi = gl.getUniformLocation(program, 'u_psi');\r\n        program.theta = gl.getUniformLocation(program, 'u_theta');\r\n        program.f = gl.getUniformLocation(program, 'u_f');\r\n        program.h = gl.getUniformLocation(program, 'u_h');\r\n        program.v = gl.getUniformLocation(program, 'u_v');\r\n        program.vo = gl.getUniformLocation(program, 'u_vo');\r\n        program.rot = gl.getUniformLocation(program, 'u_rot');\r\n        gl.uniform1f(program.h, haov / (Math.PI * 2.0));\r\n        gl.uniform1f(program.v, vaov / Math.PI);\r\n        gl.uniform1f(program.vo, voffset / Math.PI * 2);\r\n        if (imageType == 'equirectangular') {\r\n            program.backgroundColor = gl.getUniformLocation(program, 'u_backgroundColor');\r\n            gl.uniform4fv(program.backgroundColor, color.concat([1]));\r\n        }\r\n        program.texture = gl.createTexture();\r\n        gl.bindTexture(glBindType, program.texture);\r\n        if (imageType == 'cubemap') {\r\n            gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[1]);\r\n            gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_X, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[3]);\r\n            gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Y, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[4]);\r\n            gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[5]);\r\n            gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_Z, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[0]);\r\n            gl.texImage2D(gl.TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image[2]);\r\n        } else {\r\n            if (image.width <= maxWidth) {\r\n                gl.uniform1i(gl.getUniformLocation(program, 'u_splitImage'), 0);\r\n                gl.texImage2D(glBindType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image);\r\n            } else {\r\n                gl.uniform1i(gl.getUniformLocation(program, 'u_splitImage'), 1);\r\n                let cropCanvas = document.createElement('canvas');\r\n                cropCanvas.width = image.width / 2;\r\n                cropCanvas.height = image.height;\r\n                let cropContext = cropCanvas.getContext('2d');\r\n                cropContext.drawImage(image, 0, 0);\r\n                let cropImage = cropContext.getImageData(0, 0, image.width / 2, image.height);\r\n                gl.texImage2D(glBindType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, cropImage);\r\n                program.texture2 = gl.createTexture();\r\n                gl.activeTexture(gl.TEXTURE1);\r\n                gl.bindTexture(glBindType, program.texture2);\r\n                gl.uniform1i(gl.getUniformLocation(program, 'u_image1'), 1);\r\n                cropContext.drawImage(image, -image.width / 2, 0);\r\n                cropImage = cropContext.getImageData(0, 0, image.width / 2, image.height);\r\n                gl.texImage2D(glBindType, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, cropImage);\r\n                gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n                gl.texParameteri(glBindType, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n                gl.texParameteri(glBindType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n                gl.texParameteri(glBindType, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n                gl.activeTexture(gl.TEXTURE0);\r\n            }\r\n        }\r\n        if (imageType != \"cubemap\" && image.width && image.width <= maxWidth && haov == 2 * Math.PI && (image.width & (image.width - 1)) == 0){\r\n            gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n        }else{\r\n            gl.texParameteri(glBindType, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        }\r\n        gl.texParameteri(glBindType, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(glBindType, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        gl.texParameteri(glBindType, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        let err = gl.getError();\r\n        if (err !== 0) {\r\n            throw {type: 'Something went wrong with WebGL!'};\r\n        }\r\n        callback();\r\n    };\r\n\r\n    /**\r\n     * 销毁renderer.\r\n     * @memberof PanoramaRenderer\r\n     * @instance\r\n     */\r\n    this.destroy = function () {\r\n        if (container !== undefined) {\r\n            if (canvas !== undefined && container.contains(canvas)) {\r\n                container.removeChild(canvas);\r\n            }\r\n        }\r\n        if (gl) {\r\n            let extension = gl.getExtension('WEBGL_lose_context');\r\n            if (extension)\r\n                extension.loseContext();\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 重置大小\r\n     * @memberof PanoramaRenderer\r\n     * @instance\r\n     */\r\n    this.resize = function () {\r\n        let pixelRatio = window.devicePixelRatio || 1;\r\n        canvas.width = canvas.clientWidth * pixelRatio;\r\n        canvas.height = canvas.clientHeight * pixelRatio;\r\n        if (gl) {\r\n            if (gl.getError() == 1286)\r\n                handleWebGLError1286();\r\n            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n            if (image.shtHash) {\r\n                gl.useProgram(previewProgram);\r\n                gl.uniform1f(previewProgram.aspectRatio, canvas.clientWidth / canvas.clientHeight);\r\n                gl.useProgram(program);\r\n            } else {\r\n                gl.uniform1f(program.aspectRatio, canvas.clientWidth / canvas.clientHeight);\r\n            }\r\n        }\r\n    };\r\n    if (canvas) {\r\n        this.resize();\r\n    }\r\n\r\n    /**\r\n     * 设置渲染水平俯仰和滚动弧度。\r\n     * @memberof PanoramaRenderer\r\n     * @instance\r\n     * @param {number} horizonPitchRadian - 俯仰弧度（弧度 = 角度 ×（PI/180））\r\n     * @param {number} horizonRollRadian - 旋转弧度（弧度 = 角度 ×（PI/180））\r\n     */\r\n    this.setPose = function (horizonPitchRadian, horizonRollRadian) {\r\n        horizonPitchRadian = isNaN(horizonPitchRadian) ? 0 : Number(horizonPitchRadian);\r\n        horizonRollRadian = isNaN(horizonRollRadian) ? 0 : Number(horizonRollRadian);\r\n        if (horizonPitchRadian == 0 && horizonRollRadian == 0) {\r\n            pose = undefined;\r\n        } else {\r\n            pose = [horizonPitchRadian, horizonRollRadian];\r\n        }\r\n    };\r\n    /**\r\n     * 获取【俯仰弧度，旋转弧度】\r\n     * @returns {number[]|*}\r\n     */\r\n    this.getPose = function(){\r\n        if(pose){\r\n            return pose;\r\n        }\r\n        return [0,0];\r\n    }\r\n    /**\r\n     * 渲染新图.\r\n     * @memberof PanoramaRenderer\r\n     * @instance\r\n     * @param {number} pitch - 俯仰弧度（弧度 = 角度 ×（PI/180））。\r\n     * @param {number} yaw - 偏航弧度（弧度 = 角度 ×（PI/180））。\r\n     * @param {number} hfov - 水平视场弧度（弧度 = 角度 ×（PI/180））。\r\n     * @param {Object} [params] - 额外的配置参数。\r\n     * @param {number} [params.roll] - 相机转动弧度（弧度 = 角度 ×（PI/180））。\r\n     * @param {string} [params.returnImage] - 返回渲染图像?如果指定，应该是'ImageBitmap'， 'image/jpeg'或'image/png'。\r\n     * @param {function} [params.hook] - 钩子，用于在此环境中执行任意函数。\r\n     */\r\n    this.render = function (pitch, yaw, hfov, params) {\r\n        let focal, roll = 0;\r\n        if (!params){\r\n            params = {};\r\n        }\r\n        if (params.roll){\r\n            roll = params.roll;\r\n        }\r\n\r\n        if (pose !== undefined) {\r\n            let horizonPitchRadian = pose[0], horizonRollRadian = pose[1];\r\n            // Calculate new pitch and yaw\r\n            let orig_pitch = pitch, orig_yaw = yaw,\r\n                x = Math.cos(horizonRollRadian) * Math.sin(pitch) * Math.sin(horizonPitchRadian) +\r\n                    Math.cos(pitch) * (Math.cos(horizonPitchRadian) * Math.cos(yaw) +\r\n                    Math.sin(horizonRollRadian) * Math.sin(horizonPitchRadian) * Math.sin(yaw)),\r\n                y = -Math.sin(pitch) * Math.sin(horizonRollRadian) +\r\n                    Math.cos(pitch) * Math.cos(horizonRollRadian) * Math.sin(yaw),\r\n                z = Math.cos(horizonRollRadian) * Math.cos(horizonPitchRadian) * Math.sin(pitch) +\r\n                    Math.cos(pitch) * (-Math.cos(yaw) * Math.sin(horizonPitchRadian) +\r\n                    Math.cos(horizonPitchRadian) * Math.sin(horizonRollRadian) * Math.sin(yaw));\r\n            pitch = Math.asin(Math.max(Math.min(z, 1), -1));\r\n            yaw = Math.atan2(y, x);\r\n\r\n            // Calculate roll\r\n            let v = [Math.cos(orig_pitch) * (Math.sin(horizonRollRadian) * Math.sin(horizonPitchRadian) * Math.cos(orig_yaw) -\r\n                    Math.cos(horizonPitchRadian) * Math.sin(orig_yaw)),\r\n                    Math.cos(orig_pitch) * Math.cos(horizonRollRadian) * Math.cos(orig_yaw),\r\n                    Math.cos(orig_pitch) * (Math.cos(horizonPitchRadian) * Math.sin(horizonRollRadian) * Math.cos(orig_yaw) +\r\n                    Math.sin(orig_yaw) * Math.sin(horizonPitchRadian))],\r\n                w = [-Math.cos(pitch) * Math.sin(yaw), Math.cos(pitch) * Math.cos(yaw)];\r\n            let roll_adj = Math.acos(Math.max(Math.min((v[0] * w[0] + v[1] * w[1]) / (Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2]) * Math.sqrt(w[0] * w[0] + w[1] * w[1])), 1), -1));\r\n            if (v[2] < 0)\r\n                roll_adj = 2 * Math.PI - roll_adj;\r\n            roll += roll_adj;\r\n        }\r\n        if (params.hook) {\r\n            params.hook({\r\n                gl: gl,\r\n                program: program,\r\n                previewProgram: previewProgram,\r\n                imageType: imageType,\r\n                texCoordBuffer: texCoordBuffer,\r\n                cubeVertBuf: cubeVertBuf,\r\n                cubeVertTexCoordBuf: cubeVertTexCoordBuf,\r\n                cubeVertIndBuf: cubeVertIndBuf\r\n            });\r\n        }\r\n\r\n        // Calculate focal length from vertical field of view\r\n        let vfov = 2 * Math.atan(Math.tan(hfov * 0.5) / (gl.drawingBufferWidth / gl.drawingBufferHeight));\r\n        focal = 1 / Math.tan(vfov * 0.5);\r\n\r\n        // Pass psi, theta, roll, and focal length\r\n        gl.uniform1f(program.psi, yaw);\r\n        gl.uniform1f(program.theta, pitch);\r\n        gl.uniform1f(program.rot, roll);\r\n        gl.uniform1f(program.f, focal);\r\n\r\n        // Draw using current buffer\r\n        gl.drawArrays(gl.TRIANGLES, 0, 6);\r\n        if (params.returnImage !== undefined) {\r\n            if (window.createImageBitmap && params.returnImage == 'ImageBitmap') {\r\n                return createImageBitmap(canvas);\r\n            } else {\r\n                if (params.returnImage.toString().indexOf('image/') == 0)\r\n                    return canvas.toDataURL(params.returnImage);\r\n                else\r\n                    return canvas.toDataURL('image/png'); // Old default\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * 返回canvas\r\n     * @memberof PanoramaRenderer\r\n     * @instance\r\n     * @returns {HTMLElement} PanoramaRenderer's canvas.\r\n     */\r\n    this.getCanvas = function () {\r\n        return canvas;\r\n    };\r\n\r\n    /**\r\n     * 创建立方体顶点数组。\r\n     * @private\r\n     * @returns {Float32Array} Cube vertex array.\r\n     */\r\n    function createCube() {\r\n        return new Float32Array([\r\n            -1, 1, -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, // Front face\r\n            1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, // Back face\r\n            -1, 1, 1, 1, 1, 1, 1, 1, -1, -1, 1, -1, // Up face\r\n            -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1, // Down face\r\n            -1, 1, 1, -1, 1, -1, -1, -1, -1, -1, -1, 1, // Left face\r\n            1, 1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1  // Right face\r\n        ]);\r\n    }\r\n\r\n    /**\r\n     * 在iOS (iPhone 5c, iOS 10.3)上，当画布太大时，会发生此WebGL错误。\r\n     * 不幸的是，没有办法事先测试这一点，所以我们减少画布的大小，如果这个错误被抛出。\r\n     * @private\r\n     */\r\n    function handleWebGLError1286() {\r\n        console.log('由于错误1286，正在减少画布大小!');\r\n        canvas.width = Math.round(canvas.width / 2);\r\n        canvas.height = Math.round(canvas.height / 2);\r\n    }\r\n\r\n}\r\n","<template>\r\n<div class=\"home\">\r\n  <!--全景图视图区域，全屏操作-->\r\n  <div ref=\"container\" id=\"container\" class=\"pnlm-container\">\r\n    <!--操作区域，位于最上层-->\r\n    <div ref=\"uiControls\" class=\"pnlm-ui\">\r\n      <div ref=\"dragControl\" class=\"pnlm-dragfix\"></div>\r\n      <!--hotSpots区域-->\r\n      <div :ref=\"item.id\" class=\"hotspot-base\" @mousedown=\"hotspotDown($event, item)\" @mouseup=\"hotspotUp($event, item)\" @mousemove=\"hotspotMove($event, item)\" v-for=\"item in getHotSpots\">\r\n        <div class=\"tooltip-container\">\r\n          <div class=\"tooltip\">\r\n            <img src=\"../assets/img/position.png\"/>\r\n            <div class=\"tooltip-text\">{{item.text}}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <!-- 指南针     -->\r\n      <div ref=\"compass\" class=\"pnlm-compass\"></div>\r\n    </div>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport PanoramaRenderer from '../panorama/PanoramaRenderer.js'\r\nexport default {\r\n  name: \"Viewer\",\r\n  props: {\r\n    autoRotate: {\r\n      type: Boolean,\r\n      required: true\r\n    },\r\n    hotSpots: {\r\n      type: Array,\r\n      default: function () {\r\n        return []\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n    getHotSpots: function() {\r\n      return this.hotSpots;\r\n    }\r\n  },\r\n  watch: {\r\n    autoRotate(newVal, oldVal) {\r\n      this.config.autoRotate = newVal;\r\n      this.animate();\r\n    },\r\n    getHotSpots(newVal, oldVal){\r\n      console.log(newVal);\r\n      this.$nextTick(()=>{\r\n        this.renderHotSpots();\r\n      })\r\n    }\r\n  },\r\n  data(){\r\n    return {\r\n      panoImage: null,// 全景图\r\n      renderer: null,// 渲染器\r\n      animating: false,// 渲染中\r\n      defaultConfig:{\r\n        minHfov: 50,// （默认）最小水平视野\r\n        maxHfov: 120,// （默认）最大水平视野\r\n        imageType: 'equirectangular', // （初始化）图片的类型: `equirectangular`, `cubemap`\r\n        origPitch: 0,// （渲染）垂直俯仰角度（以度为单位）,默认0，范围[-90,90]\r\n        origYaw: 0,// （渲染）水平转动角度（以度为单位）,默认0\r\n        origHfov: 100,// （渲染）全景图的起始水平视野（以度为单位）,默认100,[50-120]\r\n        autoRotate: false,// （渲染）自动旋转\r\n      },// 初始配置\r\n      config: {\r\n        pitch: 0,// （渲染）俯仰角描述了摄像机的垂直旋转角度（以度为单位）,默认0，范围[-90,90]\r\n        yaw: 0,// （渲染）偏航角描述了摄像机的水平旋转角度（以度为单位）,默认0，范围[-360, 360]\r\n        hfov: 100,// （渲染）水平视场角描述了摄像机在水平方向上能够捕捉到的视野范围（以度为单位）,默认100,[50-120]\r\n        autoRotate: false,// 自动旋转\r\n      },// 全景图当前配置（摄像机的参数）\r\n      pointer: {\r\n        isUserDown: false,// 是否用户点下\r\n        onPointerDownPointerX: 0,// 鼠标点击x\r\n        onPointerDownPointerY: 0,// 鼠标点击y\r\n        onPointerDownYaw: 0,// 鼠标点击时yaw\r\n        onPointerDownPitch: 0,// 鼠标点击时pitch\r\n        onPointerDownPointerDist: -1,// 双指扩散距离（移动端双指缩放）\r\n      },// 手指触发转动中间变量\r\n      resizeObserver: null,// 窗口大小改变事件\r\n      moveHotspotId: null,// 移动热点\r\n    }\r\n  },\r\n  methods:{\r\n    // 加载图片\r\n    loadImage(imgUrl){\r\n      let _this = this;\r\n      // 加载图片\r\n      const panoImage = new Image();\r\n      panoImage.crossOrigin = 'anonymous';\r\n      panoImage.onload = function() {\r\n        _this.init();\r\n      }\r\n      panoImage.onerror = function() {\r\n        console.log('panoImage加载失败！');\r\n      }\r\n      panoImage.src = imgUrl?imgUrl:'building.jpg';\r\n      this.panoImage = panoImage;\r\n    },\r\n    // 初始化（初始化参数）\r\n    init(){\r\n      let _this = this;\r\n      let renderer;\r\n      if(!_this.renderer){\r\n        renderer = new PanoramaRenderer(document.getElementById('container'));\r\n      } else {\r\n        renderer = _this.renderer\r\n      }\r\n      renderer.init(this.panoImage, this.defaultConfig.imageType, ()=>{\r\n        _this.renderer = renderer;\r\n        _this.animate();\r\n      }, null);\r\n    },\r\n    // 渲染（避免重复）\r\n    animate(){\r\n      if(!this.animating){\r\n        this.animating = true;\r\n        this.render();\r\n      }\r\n    },\r\n    // 渲染（取config的参数渲染）\r\n    render() {\r\n      if (this.renderer) {\r\n        let { pitch, yaw, hfov } = this.config;\r\n        // 纠正yaw在[-360, 360]之间\r\n        if (yaw > 360) {\r\n          yaw -= 360;\r\n        } else if (yaw < -360) {\r\n          yaw += 360;\r\n        }\r\n        this.config.yaw = yaw;\r\n        this.renderer.render(pitch * Math.PI / 180, yaw * Math.PI / 180, hfov * Math.PI / 180, null);\r\n        if(this.pointer.isUserDown){\r\n          // 用户操作，一直渲染\r\n          requestAnimationFrame(this.render);\r\n        } else if(this.config.autoRotate){\r\n          this.config.yaw += 0.1;// 更新旋转角度\r\n          requestAnimationFrame(this.render);\r\n        } else {\r\n          // 停止渲染\r\n          this.animating = false;\r\n        }\r\n        this.renderHotSpots();\r\n        const compass = this.$refs.compass;\r\n        compass.style.transform = 'rotate(' + (-yaw - 0) + 'deg)';\r\n        compass.style.webkitTransform = 'rotate(' + (-yaw - 0) + 'deg)';\r\n      }\r\n    },\r\n    renderHotSpots() {\r\n      this.hotSpots.forEach(this.renderHotSpot);\r\n    },\r\n    // 渲染热点，计算点位\r\n    renderHotSpot(hs) {\r\n      const {id, pitch:HsPitch, yaw:HsYaw} = hs;\r\n      const hsDiv = this.$refs[id][0];\r\n      let { pitch, yaw, hfov } = this.config;\r\n      let hsPitchSin = Math.sin(HsPitch * Math.PI / 180),// 热点垂直角度sin值（sin=对边/斜边）\r\n          hsPitchCos = Math.cos(HsPitch * Math.PI / 180),// 热点垂直角度cos值（cos=领边/斜边）\r\n          configPitchSin = Math.sin(pitch * Math.PI / 180),// 当前垂直角度sin值\r\n          configPitchCos = Math.cos(pitch * Math.PI / 180),// 当前垂直角度cos值\r\n          yawCos = Math.cos((-HsYaw + yaw) * Math.PI / 180);// （当前水平角度-热点水平角度）角度差的cos值\r\n      let z = hsPitchSin * configPitchSin + hsPitchCos * yawCos * configPitchCos;\r\n      if ((HsYaw <= 90 && HsYaw > -90 && z <= 0) || ((HsYaw > 90 || HsYaw <= -90) && z <= 0)) {\r\n        // 不在屏幕内\r\n        hsDiv.style.visibility = 'hidden';\r\n      } else {\r\n        let yawSin = Math.sin((-HsYaw + yaw) * Math.PI / 180),\r\n            hfovTan = Math.tan(hfov * Math.PI / 360);\r\n        hsDiv.style.visibility = 'visible';\r\n        let canvas = this.renderer.getCanvas(), canvasWidth = canvas.clientWidth, canvasHeight = canvas.clientHeight;\r\n        let coord = [-canvasWidth / hfovTan * yawSin * hsPitchCos / z / 2, -canvasWidth / hfovTan * (hsPitchSin * configPitchCos - hsPitchCos * yawCos * configPitchSin) / z / 2];\r\n        // 应用滚动\r\n        let rollSin = Math.sin(0), rollCos = Math.cos(0);\r\n        coord = [coord[0] * rollCos - coord[1] * rollSin, coord[0] * rollSin + coord[1] * rollCos];\r\n        // 应用变换\r\n        coord[0] += (canvasWidth - hsDiv.offsetWidth) / 2;\r\n        coord[1] += (canvasHeight - hsDiv.offsetHeight) / 2;\r\n        let transform = 'translate(' + coord[0] + 'px, ' + coord[1] + 'px) translateZ(9999px)';\r\n        hsDiv.style.webkitTransform = transform;\r\n        hsDiv.style.MozTransform = transform;\r\n        hsDiv.style.transform = transform;\r\n      }\r\n    },\r\n    // 标签事件添加\r\n    domEventAdd(){\r\n      const {container, uiControls, dragControl} = this.$refs;\r\n      // 鼠标滚轮事件---缩放视野，兼容火狐·DOMMouseScroll·\r\n      uiControls.addEventListener('mousewheel', this.onDocumentMouseWheel, false);// 第三个参数：false由内而外冒泡，true则由外而内\r\n      uiControls.addEventListener('DOMMouseScroll', this.onDocumentMouseWheel, false);\r\n      // 鼠标or手指拖动事件---垂直和水平转动，兼容pc和移动端\r\n      dragControl.addEventListener('mousedown', this.onDocumentMouseDown, false);// (PC端)鼠标按下\r\n      dragControl.addEventListener('mousemove', this.onDocumentMouseMove, false);// (PC端)鼠标移动\r\n      dragControl.addEventListener('mouseup', this.onDocumentMouseUp, false);// (PC端)鼠标抬起\r\n      dragControl.addEventListener('mouseleave', this.onDocumentMouseUp, false);// (PC端)鼠标离开\r\n      dragControl.addEventListener('touchstart', this.onDocumentTouchStart, false);// (移动端)触摸开始\r\n      dragControl.addEventListener('touchmove', this.onDocumentTouchMove, false);// (移动端)触摸移动\r\n      dragControl.addEventListener('touchend', this.onDocumentTouchEnd, false);// (移动端)触摸结束\r\n      // 双击聚焦or还原\r\n      dragControl.addEventListener('dblclick', this.onDocumentDoubleClick, false);\r\n      // 全屏事件（各浏览器）\r\n      container.addEventListener('mozfullscreenchange', this.onDocumentResize, false);\r\n      container.addEventListener('webkitfullscreenchange', this.onDocumentResize, false);\r\n      container.addEventListener('msfullscreenchange', this.onDocumentResize, false);\r\n      container.addEventListener('fullscreenchange', this.onDocumentResize, false);\r\n      // 窗口大小监控\r\n      if (typeof ResizeObserver === 'function') {\r\n        const resizeObserver = new ResizeObserver(this.onDocumentResize);\r\n        resizeObserver.observe(container);\r\n        this.resizeObserver = resizeObserver;\r\n      } else {\r\n        window.addEventListener('resize', this.onDocumentResize, false);\r\n        window.addEventListener('orientationchange', this.onDocumentResize, false);\r\n      }\r\n    },\r\n    // 【鼠标滚轮】事件处理\r\n    onDocumentMouseWheel(event) {\r\n      if (!this.renderer) {\r\n        return;\r\n      }\r\n      event.preventDefault();// 阻止标签默认事件（选中该元素）\r\n      const { pitch, yaw, hfov } = this.config;\r\n      if (event.wheelDeltaY) {\r\n        // WebKit浏览器\r\n        this.config.hfov = this.calcHfov(hfov - event.wheelDeltaY * 0.05);\r\n        // speed.hfov = event.wheelDelta < 0 ? 1 : -1;\r\n      } else if (event.wheelDelta) {\r\n        // Opera / Explorer 9浏览器\r\n        this.config.hfov = this.calcHfov(hfov - event.wheelDelta * 0.05);\r\n        // speed.hfov = event.wheelDelta < 0 ? 1 : -1;\r\n      } else if (event.detail) {\r\n        // Firefox浏览器\r\n        this.config.hfov = this.calcHfov(hfov + event.detail * 1.5);\r\n        // speed.hfov = event.detail > 0 ? 1 : -1;\r\n      }\r\n      this.animate();// 手动渲染\r\n    },\r\n    // 计算水平视野变化\r\n    calcHfov(hfov){\r\n      const {minHfov, maxHfov} = this.defaultConfig;\r\n      return hfov < minHfov ? minHfov : (hfov > maxHfov? maxHfov: hfov);\r\n    },\r\n    //【鼠标按下】事件处理(PC端)\r\n    onDocumentMouseDown(event) {\r\n      // 鼠标抓取样式\r\n      const {container, uiControls} = this.$refs;\r\n      uiControls.style.cursor = 'move';\r\n      event.preventDefault();// 阻止标签默认事件（选中元素）\r\n      container.focus();// 选中【container】\r\n      if (!this.renderer) {\r\n        return;\r\n      }\r\n      // 计算鼠标点击相对【container】位置[x, y]\r\n      let [x, y] = this.calcMousePosition(event);\r\n      // 计算鼠标位置全景图俯仰和偏航[pitch, yaw]\r\n      // let coords = mouseEventToCoords(event);\r\n      const { pitch, yaw } = this.config;\r\n      this.pointer.isUserDown = true;// 是否用户点下\r\n      this.pointer.onPointerDownPointerX = x;// 鼠标点击x\r\n      this.pointer.onPointerDownPointerY = y;// 鼠标点击y\r\n      this.pointer.onPointerDownYaw = yaw;// 鼠标点击时yaw\r\n      this.pointer.onPointerDownPitch = pitch;// 鼠标点击时pitch\r\n      this.animate();// 手动渲染\r\n    },\r\n    //【鼠标移动】事件处理(PC端)\r\n    onDocumentMouseMove(event) {\r\n      if (!this.renderer || !this.pointer.isUserDown) {\r\n        return;\r\n      }\r\n      const canvas = this.renderer.getCanvas();\r\n      let canvasWidth = canvas.clientWidth,canvasHeight = canvas.clientHeight;\r\n      const [x, y] = this.calcMousePosition(event);\r\n      const { onPointerDownPointerX, onPointerDownPointerY, onPointerDownYaw, onPointerDownPitch } = this.pointer;\r\n      const { hfov } = this.config;\r\n      this.config.yaw = ((Math.atan(onPointerDownPointerX / canvasWidth * 2 - 1) - Math.atan(x / canvasWidth * 2 - 1)) * 180 / Math.PI * hfov / 90) + onPointerDownYaw;\r\n      let newVfov = 2 * Math.atan(Math.tan(hfov/360*Math.PI) * canvasHeight / canvasWidth) * 180 / Math.PI;\r\n      this.config.pitch = ((Math.atan(y / canvasHeight * 2 - 1) - Math.atan(onPointerDownPointerY / canvasHeight * 2 - 1)) * 180 / Math.PI * newVfov / 90) + onPointerDownPitch;\r\n    },\r\n    //【鼠标抬起】事件处理(PC端)\r\n    onDocumentMouseUp(event) {\r\n      const {uiControls} = this.$refs;\r\n      uiControls.style.cursor = 'default';\r\n      this.pointer.isUserDown = false;// 是否用户点下\r\n    },\r\n    //【触摸开始】事件处理(移动端)\r\n    onDocumentTouchStart(event) {\r\n      if (!this.renderer) {\r\n        return;\r\n      }\r\n      // 计算鼠标点击相对【container】位置[x, y]\r\n      let [x1, y1] = this.calcMousePosition(event.targetTouches[0]);\r\n      let onPointerDownPointerX = x1;\r\n      let onPointerDownPointerY = y1;\r\n      if (event.targetTouches.length == 2) {\r\n        // 向下指针是两个手指的中心\r\n        let [x2, y2] = this.calcMousePosition(event.targetTouches[1]);\r\n        onPointerDownPointerX += (x2 - x1) * 0.5;\r\n        onPointerDownPointerY += (y2 - y1) * 0.5;\r\n        this.pointer.onPointerDownPointerDist = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\r\n      }\r\n      const { pitch, yaw } = this.config;\r\n      this.pointer.isUserDown = true;// 是否用户点下\r\n      this.pointer.onPointerDownPointerX = onPointerDownPointerX;// 鼠标点击x\r\n      this.pointer.onPointerDownPointerY = onPointerDownPointerY;// 鼠标点击y\r\n      this.pointer.onPointerDownYaw = yaw;// 鼠标点击时yaw\r\n      this.pointer.onPointerDownPitch = pitch;// 鼠标点击时pitch\r\n      this.animate();// 手动渲染\r\n    },\r\n    //【触摸移动】事件处理(移动端)\r\n    onDocumentTouchMove(event) {\r\n      if (!this.renderer || !this.pointer.isUserDown) {\r\n        return;\r\n      }\r\n      const { hfov } = this.config;\r\n      const { onPointerDownPointerX, onPointerDownPointerY, onPointerDownYaw, onPointerDownPitch, onPointerDownPointerDist } = this.pointer;\r\n      let [x1, y1] = this.calcMousePosition(event.targetTouches[0]);\r\n      let clientX = x1;\r\n      let clientY = y1;\r\n      if (event.targetTouches.length == 2 && onPointerDownPointerDist != -1) {\r\n        let [x2, y2] = calcMousePosition(event.targetTouches[1]);\r\n        clientX += (x2 - x1) * 0.5;\r\n        clientY += (y2 - y1) * 0.5;\r\n        let clientDist = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\r\n        // 修改视角（移动端双指缩放）\r\n        this.config.hfov = this.calcHfov(hfov + (onPointerDownPointerDist - clientDist) * 0.1);\r\n        this.pointer.onPointerDownPointerDist = clientDist;\r\n      }\r\n      this.config.yaw = (onPointerDownPointerX - clientX) * (hfov / 360) * 2 + onPointerDownYaw;\r\n      this.config.pitch = (clientY - onPointerDownPointerY) * (hfov / 360) * 2 + onPointerDownPitch;\r\n    },\r\n    //【触摸结束】事件处理(移动端)\r\n    onDocumentTouchEnd() {\r\n      this.pointer.onPointerDownPointerDist = -1;\r\n      this.pointer.isUserDown = false;// 是否用户点下\r\n    },\r\n    // 计算点击、触摸位置[x,y]\r\n    calcMousePosition(event) {\r\n      const { container } = this.$refs;\r\n      let bounds = container.getBoundingClientRect();// 获取元素上下左右距离浏览器窗口距离，以及自己的宽高{top,lef,right,bottom,width,height}\r\n      // iOS是 pageX / pageY\r\n      let x = (event.clientX || event.pageX) - bounds.left;\r\n      let y = (event.clientY || event.pageY) - bounds.top;\r\n      return [x,y];\r\n    },\r\n    // 双击聚焦or还原\r\n    onDocumentDoubleClick(event) {\r\n      if (!this.renderer) {\r\n        return;\r\n      }\r\n      const { minHfov,origHfov } = this.defaultConfig;\r\n      const { hfov } = this.config;\r\n      if (minHfov === hfov) {\r\n        this.config.hfov = origHfov;\r\n      } else {\r\n        let [pitchPointer, yawPointer] = this.mouseEventToCoords(event);\r\n        this.config.pitch = pitchPointer;\r\n        this.config.yaw = yawPointer;\r\n        this.config.hfov = minHfov;\r\n      }\r\n      this.render();// 手动渲染\r\n    },\r\n    // 计算鼠标位置垂直俯仰角度、水平转动角度[pitch, yaw]\r\n    mouseEventToCoords(event) {\r\n      let [x,y] = this.calcMousePosition(event);// 获取鼠标相对【container】位置【x,y】\r\n      let canvas = this.renderer.getCanvas();\r\n      let canvasWidth = canvas.clientWidth, canvasHeight = canvas.clientHeight;\r\n      x = x / canvasWidth * 2 - 1;\r\n      y = (1 - y / canvasHeight * 2) * canvasHeight / canvasWidth;\r\n      let { pitch, yaw, hfov } = this.config;\r\n      let focal = 1 / Math.tan(hfov * Math.PI / 360);\r\n      let s = Math.sin(pitch * Math.PI / 180);\r\n      let c = Math.cos(pitch * Math.PI / 180);\r\n      let a = focal * c - y * s;\r\n      let root = Math.sqrt(x*x + a*a);\r\n      pitch = Math.atan((y * c + focal * s) / root) * 180 / Math.PI;\r\n      yaw = Math.atan2(x / root, a / root) * 180 / Math.PI + yaw;\r\n      if (yaw < -180){\r\n        yaw += 360;\r\n      }\r\n      if (yaw > 180){\r\n        yaw -= 360;\r\n      }\r\n      return [pitch, yaw];\r\n    },\r\n    // 【全屏】【窗口改变】事件处理(PC端)\r\n    onDocumentResize() {\r\n      if(this.renderer){\r\n        this.renderer.resize();\r\n      }\r\n    },\r\n    // 【全屏】判断当前是否全屏状态\r\n    isFullscreenActive(){\r\n      if (document.fullscreenElement || document.fullscreen || document.mozFullScreen || document.webkitIsFullScreen || document.msFullscreenElement) {\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    },\r\n    /**\r\n     * 操作按钮：全屏、放大、缩小\r\n     */\r\n    // 全屏\r\n    toggleFullscreen() {\r\n      try {\r\n        if (this.renderer) {\r\n          if (!this.isFullscreenActive()) {\r\n            const {container} = this.$refs;\r\n            // 全屏\r\n            if (container.requestFullscreen) {\r\n              container.requestFullscreen();\r\n            } else if (container.mozRequestFullScreen) {\r\n              container.mozRequestFullScreen();\r\n            } else if (container.msRequestFullscreen) {\r\n              container.msRequestFullscreen();\r\n            } else {\r\n              container.webkitRequestFullScreen();\r\n            }\r\n          } else {\r\n            // 取消全屏\r\n            if (document.exitFullscreen) {\r\n              document.exitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n              document.mozCancelFullScreen();\r\n            } else if (document.webkitCancelFullScreen) {\r\n              document.webkitCancelFullScreen();\r\n            } else if (document.msExitFullscreen) {\r\n              document.msExitFullscreen();\r\n            }\r\n          }\r\n        }\r\n      } catch(event) {\r\n        console.error(\"全屏问题：\", event);\r\n      }\r\n    },\r\n    // 热点\r\n    hotspotDown(event, hs){\r\n      this.moveHotspotId = hs.id;\r\n    },\r\n    hotspotMove(event, hs){\r\n      if(this.moveHotspotId == hs.id){\r\n        let coords = this.mouseEventToCoords(event);\r\n        hs.pitch = coords[0];\r\n        hs.yaw = coords[1];\r\n        this.renderHotSpot(hs);\r\n      }\r\n    },\r\n    hotspotUp(event, hs){\r\n      this.moveHotspotId = null;\r\n    },\r\n  },\r\n  destroyed() {\r\n    try{\r\n        if(this.renderer){\r\n          this.renderer.destroy();\r\n        }\r\n        const {container, uiControls, dragControl} = this.$refs;\r\n        // 鼠标滚轮事件---缩放视野，兼容火狐·DOMMouseScroll·\r\n        uiControls.removeEventListener('mousewheel', this.onDocumentMouseWheel, false);// 第三个参数：false由内而外冒泡，true则由外而内\r\n        uiControls.removeEventListener('DOMMouseScroll', this.onDocumentMouseWheel, false);\r\n        // 鼠标or手指拖动事件---垂直和水平转动，兼容pc和移动端\r\n        dragControl.removeEventListener('mousedown', this.onDocumentMouseDown, false);// (PC端)鼠标按下\r\n        dragControl.removeEventListener('mousemove', this.onDocumentMouseMove, false);// (PC端)鼠标移动\r\n        dragControl.removeEventListener('mouseup', this.onDocumentMouseUp, false);// (PC端)鼠标抬起\r\n        dragControl.removeEventListener('mouseleave', this.onDocumentMouseUp, false);// (PC端)鼠标离开\r\n        dragControl.removeEventListener('touchstart', this.onDocumentTouchStart, false);// (移动端)触摸开始\r\n        dragControl.removeEventListener('touchmove', this.onDocumentTouchMove, false);// (移动端)触摸移动\r\n        dragControl.removeEventListener('touchend', this.onDocumentTouchEnd, false);// (移动端)触摸结束\r\n      // 双击聚焦or还原\r\n        dragControl.removeEventListener('dblclick', this.onDocumentDoubleClick, false);\r\n        // 全屏事件（各浏览器）\r\n        container.removeEventListener('mozfullscreenchange', this.onDocumentResize, false);\r\n        container.removeEventListener('webkitfullscreenchange', this.onDocumentResize, false);\r\n        container.removeEventListener('msfullscreenchange', this.onDocumentResize, false);\r\n        container.removeEventListener('fullscreenchange', this.onDocumentResize, false);\r\n        // 窗口大小监控\r\n        if (typeof ResizeObserver === 'function') {\r\n          this.resizeObserver.disconnect();\r\n        } else {\r\n          window.removeEventListener('resize', this.onDocumentResize, false);\r\n          window.removeEventListener('orientationchange', this.onDocumentResize, false);\r\n        }\r\n    }catch (e) {\r\n    }\r\n  },\r\n  mounted() {\r\n    // this.loadImage();\r\n    this.domEventAdd();\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.home {\r\n  height: 100%;\r\n  width: 100%;\r\n  .pnlm-container {\r\n    width: 100%;\r\n    height: 100%;\r\n    margin: 0;\r\n    padding: 0;\r\n    position: relative;\r\n    overflow: hidden;\r\n    font-family: Helvetica, \"Nimbus Sans L\", \"Liberation Sans\", Arial, sans-serif;\r\n    cursor: default;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -o-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    outline: 0;\r\n    contain: content;\r\n    direction: ltr;\r\n  }\r\n  .pnlm-container * {\r\n    box-sizing: content-box;\r\n  }\r\n  .pnlm-container:-moz-full-screen {\r\n    height: 100% !important;\r\n    width: 100% !important;\r\n    position: static !important;\r\n  }\r\n  .pnlm-container:-webkit-full-screen {\r\n    height: 100% !important;\r\n    width: 100% !important;\r\n    position: static !important;\r\n  }\r\n  .pnlm-container:-ms-fullscreen {\r\n    height: 100% !important;\r\n    width: 100% !important;\r\n    position: static !important;\r\n  }\r\n  .pnlm-container:fullscreen {\r\n    height: 100% !important;\r\n    width: 100% !important;\r\n    position: static !important;\r\n  }\r\n  .pnlm-ui {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 2;\r\n  }\r\n  .pnlm-dragfix {\r\n    position: absolute;\r\n    height: 100%;\r\n    width: 100%;\r\n  }\r\n  .pnlm-compass {\r\n    position: absolute;\r\n    width: 50px;\r\n    height: 50px;\r\n    right: 4px;\r\n    bottom: 4px;\r\n    border-radius: 50%;\r\n    background-color: #fff;\r\n    border: 1px solid #999;\r\n    background-image: url('../css/compass.svg');\r\n    cursor: default;\r\n    -webkit-transform: translateZ(9999px);\r\n    transform: translateZ(9999px);\r\n  }\r\n  .hotspot-base {\r\n    position: absolute;\r\n    visibility: hidden;\r\n    top: 0;\r\n  }\r\n  .tooltip-container {\r\n    position: relative;\r\n    display: inline-block;\r\n    .tooltip {\r\n      position: relative;\r\n      display: inline-block;\r\n      cursor: pointer;\r\n      img{\r\n        width: 30px;\r\n        height: 30px;\r\n      }\r\n    }\r\n    .tooltip-text {\r\n      white-space:nowrap;\r\n      background-color: #333;\r\n      color: #fff;\r\n      text-align: center;\r\n      border-radius: 10px;\r\n      padding: 2px 5px;\r\n      position: absolute;\r\n      z-index: 1;\r\n      top: -40px;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n      opacity: 1;\r\n      transition: opacity 0.3s;\r\n    }\r\n    .tooltip-text::after {\r\n      content: \"\";\r\n      position: absolute;\r\n      border-width: 8px;\r\n      border-style: solid;\r\n      border-color: #333 transparent transparent transparent;\r\n      top: 100%;\r\n      left: 50%;\r\n      transform: translateX(-50%);\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Viewer.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Viewer.vue?vue&type=template&id=1760afda&scoped=true\"\nimport script from \"./Viewer.vue?vue&type=script&lang=js\"\nexport * from \"./Viewer.vue?vue&type=script&lang=js\"\nimport style0 from \"./Viewer.vue?vue&type=style&index=0&id=1760afda&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1760afda\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"home\">\r\n    <div class=\"content\">\r\n      <!-- 图片区域  -->\r\n      <div class=\"image-select\">\r\n        <div class=\"img-list\">\r\n          <div @click=\"imgClick(i.id,i.imageURL)\" :class=\"{ active:currentImgId==i.id }\" class=\"img-item\" v-for=\"i in imageUrlList\">\r\n            <img class=\"img\" :src=\"i.imageURL\"/>\r\n            <div class=\"upload-name\">{{ i.name }}</div>\r\n          </div>\r\n        </div>\r\n        <div @click=\"$refs.fileUpload.click();\" class=\"upload\">\r\n          <img class=\"upload-img\" src=\"../assets/img/addImg.png\"/>\r\n          <div class=\"upload-name\">上传图片</div>\r\n          <input ref=\"fileUpload\" accept=\"image/*\" type=\"file\" @change=\"uploadFileChange()\" style=\"display: none\"/>\r\n        </div>\r\n      </div>\r\n      <!-- 面板区域   -->\r\n      <div class=\"center\">\r\n        <div class=\"img-preview\">\r\n          <Viewer :hotSpots=\"currentHotSpots\" :autoRotate=\"defaultConfig.autoRotate\" ref=\"viewImage\"></Viewer>\r\n        </div>\r\n      </div>\r\n      <!-- 编辑属性面板  -->\r\n      <div class=\"right-attribute\">\r\n        <el-form label-position=\"top\" label-width=\"80px\" :model=\"defaultConfig\">\r\n          <el-form-item>\r\n            <el-switch :disabled=\"!currentImgId\" v-model=\"defaultConfig.autoRotate\" active-text=\"自动旋转\"></el-switch>\r\n          </el-form-item>\r\n        </el-form>\r\n        <el-button :disabled=\"!currentImgId\" @click=\"addHotSpot(currentImgId)\" size=\"mini\" round>添加热点</el-button>\r\n        <div v-for=\"item in currentHotSpots\">\r\n          <el-input v-model=\"item.text\" placeholder=\"请输入内容\"></el-input>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Viewer from \"@/views/Viewer\";\r\nexport default {\r\n  name: \"EditPage\",\r\n  components: {Viewer},\r\n  data(){\r\n    return {\r\n      funTabActive: 'global',// 当前活跃tab\r\n      currentImgId: null,// 当前活跃\r\n      imageUrlList: [],// 全景图列表\r\n      defaultConfig: {\r\n        pitch: 0,// （渲染）垂直俯仰角度（以度为单位）,默认0，范围[-90,90]\r\n        yaw: 0,// （渲染）水平转动角度（以度为单位）,默认0，范围[-360, 360]\r\n        hfov: 100,// （渲染）全景图的起始水平视野（以度为单位）,默认100,[50-120]\r\n        autoRotate: false,// 自动旋转\r\n      },\r\n      hotSpots: { },// 热点（imgId:[]）\r\n      currentHotSpots: [],\r\n    }\r\n  },\r\n  methods:{\r\n    // 功能操作切换\r\n    funTabToggle(type){\r\n      this.funTabActive = type;\r\n    },\r\n    // 上传全景图\r\n    uploadFileChange() {\r\n      let _this = this;\r\n      const fileDom = this.$refs.fileUpload;\r\n      let file = fileDom.files[0];// 获取文件\r\n      fileDom.value ='';// 清空file\r\n      if (file) {\r\n        // 创建FileReader对象\r\n        const reader = new FileReader();\r\n        // 设置文件加载完成后的回调函数\r\n        reader.onload = function() {\r\n          const imageURL = reader.result; // 获取生成的URL\r\n          // 可以将URL应用到页面中的img标签等元素\r\n          let img = {\r\n            id: _this.generateUUID(),\r\n            imageURL,\r\n            name: file.name\r\n          };\r\n          _this.imageUrlList.push(img);\r\n          _this.imgClick(img.id,img.imageURL);\r\n        };\r\n        reader.readAsDataURL(file); // 读取文件并生成URL\r\n      }\r\n    },\r\n    // 生成uuid\r\n    generateUUID() {\r\n      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        const r = (Math.random() * 16) | 0,\r\n            v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n        return v.toString(16);\r\n      });\r\n    },\r\n    // 加载\r\n    imgClick(id,imageURL){\r\n      this.currentImgId = id;\r\n      this.$refs.viewImage.loadImage(imageURL);\r\n      this.currentHotSpots = this.hotSpots[id]?this.hotSpots[id]:[];\r\n    },\r\n    // 添加热点\r\n    addHotSpot(imgId){\r\n      const {pitch, yaw} = this.$refs.viewImage.config;\r\n      if(this.hotSpots[imgId]){\r\n        this.hotSpots[imgId].push({\r\n          \"id\": this.generateUUID(),\r\n          \"pitch\": pitch,\r\n          \"yaw\": yaw,\r\n          \"text\": \"我是热点\"\r\n        });\r\n      } else {\r\n        this.hotSpots[imgId] = [];\r\n        this.hotSpots[imgId].push({\r\n          \"id\": this.generateUUID(),\r\n          \"pitch\": pitch,\r\n          \"yaw\": yaw,\r\n          \"text\": \"我是热点\"\r\n        });\r\n      }\r\n      this.currentHotSpots = this.hotSpots[imgId];\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.home {\r\n  height: 100%;\r\n  width: 100%;\r\n  padding: 5px;\r\n  box-sizing: border-box;\r\n  //background-color: #f5efef;\r\n  .content{\r\n    height: 100%;\r\n    width: 100%;\r\n    border-radius: 5px;\r\n    //background-color: #000000;\r\n    overflow: hidden;\r\n    display: flex;\r\n    .image-select{\r\n      width: 110px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      overflow: hidden;\r\n      padding: 5px;\r\n      box-sizing: border-box;\r\n      background-color: #080808;\r\n      .img-list{\r\n        flex: 1;\r\n        overflow: auto;\r\n        display: flex;\r\n        align-items: center;\r\n        flex-direction: column;\r\n        .img-item{\r\n          width: 100px;\r\n          height: 60px;\r\n          border-radius: 5px;\r\n          overflow: hidden;\r\n          cursor: pointer;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          flex-direction: column;\r\n          box-sizing: border-box;\r\n          .img{\r\n            width: 100%;\r\n            height: 100%;\r\n          }\r\n          .upload-name{\r\n            position: absolute;\r\n            font-size: 12px;\r\n            color: #ffffff;\r\n          }\r\n          &:not(:first-of-type){\r\n            margin-top: 5px;\r\n          }\r\n        }\r\n        .active{\r\n          border: 2px solid #f50b0b;\r\n        }\r\n      }\r\n      .upload{\r\n        padding: 5px;\r\n        border-radius: 5px;\r\n        cursor: pointer;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        flex-direction: column;\r\n        .upload-img{\r\n          width: 50px;\r\n          height: 50px;\r\n        }\r\n        .upload-name{\r\n          font-size: 15px;\r\n          color: #ffffff;\r\n        }\r\n        &:hover{\r\n          background-color: #8aa2f3;\r\n        }\r\n      }\r\n    }\r\n    .center{\r\n      flex: 1;\r\n      display: flex;\r\n      flex-direction: column;\r\n      .img-preview{\r\n        flex: 1;\r\n        overflow: hidden;\r\n        background-color: #feffff;\r\n      }\r\n      .function-select{\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 5px;\r\n        box-sizing: border-box;\r\n        background-color: #080808;\r\n        .fun-item{\r\n          padding: 5px;\r\n          border-radius: 5px;\r\n          cursor: pointer;\r\n          display: flex;\r\n          align-items: center;\r\n          justify-content: center;\r\n          flex-direction: column;\r\n          .fun-img{\r\n            width: 30px;\r\n            height: 30px;\r\n          }\r\n          .fun-item-name{\r\n            font-size: 12px;\r\n            color: #ffffff;\r\n          }\r\n          &:not(:first-of-type){\r\n            margin-left: 5px;\r\n          }\r\n        }\r\n        .active{\r\n          background-color: #8aa2f3;\r\n        }\r\n      }\r\n    }\r\n    .right-attribute{\r\n      width: 110px;\r\n      background-color: #0c0c0c;\r\n      ::v-deep .el-switch__label{\r\n        color: #ffffff;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditPage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./EditPage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./EditPage.vue?vue&type=template&id=cb77812a&scoped=true\"\nimport script from \"./EditPage.vue?vue&type=script&lang=js\"\nexport * from \"./EditPage.vue?vue&type=script&lang=js\"\nimport style0 from \"./EditPage.vue?vue&type=style&index=0&id=cb77812a&prod&scoped=true&lang=scss\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"cb77812a\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_l","imageUrlList","i","class","active","currentImgId","id","on","$event","imgClick","imageURL","attrs","_v","_s","name","$refs","fileUpload","click","require","ref","staticStyle","uploadFileChange","currentHotSpots","defaultConfig","autoRotate","model","value","callback","$$v","$set","expression","addHotSpot","item","text","staticRenderFns","getHotSpots","refInFor","hotspotDown","hotspotUp","hotspotMove","v","join","fragEquiCubeBase","fragCube","fragEquirectangular","PanoramaRenderer","container","canvas","program","gl","vs","fs","previewProgram","previewVs","previewFs","vtmps","pose","image","imageType","texCoordBuffer","cubeVertBuf","cubeVertTexCoordBuf","cubeVertIndBuf","globalParams","createCube","Float32Array","handleWebGLError1286","console","log","width","Math","round","height","document","createElement","style","appendChild","init","_image","_imageType","params","s","haov","PI","vaov","voffset","undefined","type","detachShader","deleteShader","bindBuffer","ARRAY_BUFFER","ELEMENT_ARRAY_BUFFER","texture","deleteTexture","deleteProgram","cubeImgWidth","faceMissing","fillMissingFaces","imgSize","nbytes","imageArray","Uint8ClampedArray","rgb","backgroundColor","backgroundSquare","ImageData","navigator","userAgent","toLowerCase","match","getContext","alpha","depth","getError","basePath","fullpath","path","invTileResolution","tileResolution","vertices","slice","maxWidth","getParameter","MAX_TEXTURE_SIZE","max","MAX_CUBE_MAP_TEXTURE_SIZE","horizonPitchRadian","isNaN","Number","horizonRollRadian","glBindType","TEXTURE_2D","viewport","drawingBufferWidth","drawingBufferHeight","getShaderPrecisionFormat","precision","FRAGMENT_SHADER","HIGH_FLOAT","replace","createShader","VERTEX_SHADER","vertexSrc","shaderSource","compileShader","fragmentSrc","TEXTURE_CUBE_MAP","createProgram","attachShader","linkProgram","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","drawInProgress","color","clearColor","clear","COLOR_BUFFER_BIT","texCoordLocation","getAttribLocation","enableVertexAttribArray","createBuffer","bufferData","STATIC_DRAW","vertexAttribPointer","FLOAT","aspectRatio","getUniformLocation","uniform1f","psi","theta","f","h","vo","rot","uniform4fv","concat","createTexture","bindTexture","texImage2D","TEXTURE_CUBE_MAP_POSITIVE_X","RGB","UNSIGNED_BYTE","TEXTURE_CUBE_MAP_NEGATIVE_X","TEXTURE_CUBE_MAP_POSITIVE_Y","TEXTURE_CUBE_MAP_NEGATIVE_Y","TEXTURE_CUBE_MAP_POSITIVE_Z","TEXTURE_CUBE_MAP_NEGATIVE_Z","uniform1i","cropCanvas","cropContext","drawImage","cropImage","getImageData","texture2","activeTexture","TEXTURE1","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","TEXTURE0","REPEAT","err","destroy","contains","removeChild","extension","getExtension","loseContext","resize","pixelRatio","window","devicePixelRatio","clientWidth","clientHeight","shtHash","setPose","getPose","pitch","yaw","hfov","focal","roll","orig_pitch","orig_yaw","x","cos","sin","y","z","asin","min","atan2","w","roll_adj","acos","sqrt","hook","vfov","atan","tan","drawArrays","TRIANGLES","returnImage","createImageBitmap","toString","indexOf","toDataURL","getCanvas","props","Boolean","required","hotSpots","Array","default","computed","watch","newVal","oldVal","config","animate","$nextTick","renderHotSpots","data","panoImage","renderer","animating","minHfov","maxHfov","origPitch","origYaw","origHfov","pointer","isUserDown","onPointerDownPointerX","onPointerDownPointerY","onPointerDownYaw","onPointerDownPitch","onPointerDownPointerDist","resizeObserver","moveHotspotId","methods","loadImage","imgUrl","_this","Image","crossOrigin","onload","onerror","src","getElementById","requestAnimationFrame","compass","transform","webkitTransform","forEach","renderHotSpot","hs","HsPitch","HsYaw","hsDiv","hsPitchSin","hsPitchCos","configPitchSin","configPitchCos","yawCos","visibility","yawSin","hfovTan","canvasWidth","canvasHeight","coord","rollSin","rollCos","offsetWidth","offsetHeight","MozTransform","domEventAdd","uiControls","dragControl","addEventListener","onDocumentMouseWheel","onDocumentMouseDown","onDocumentMouseMove","onDocumentMouseUp","onDocumentTouchStart","onDocumentTouchMove","onDocumentTouchEnd","onDocumentDoubleClick","onDocumentResize","ResizeObserver","observe","event","preventDefault","wheelDeltaY","calcHfov","wheelDelta","detail","cursor","focus","calcMousePosition","newVfov","x1","y1","targetTouches","length","x2","y2","clientX","clientY","clientDist","bounds","getBoundingClientRect","pageX","left","pageY","top","pitchPointer","yawPointer","mouseEventToCoords","c","a","root","isFullscreenActive","fullscreenElement","fullscreen","mozFullScreen","webkitIsFullScreen","msFullscreenElement","toggleFullscreen","exitFullscreen","mozCancelFullScreen","webkitCancelFullScreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","msRequestFullscreen","webkitRequestFullScreen","error","coords","destroyed","removeEventListener","disconnect","e","mounted","component","components","Viewer","funTabActive","funTabToggle","fileDom","file","files","reader","FileReader","result","img","generateUUID","push","readAsDataURL","r","random","viewImage","imgId"],"sourceRoot":""}