---
title: onlyoffice文档了解
date: 2023-11-02 13:27:26
category: 其他
tags:
  - onlyoffice
---

# 描述和功能
## 1.1描述
- 一个在线办公套件，结合了文本文档、电子表格、演示文稿和表单的编辑器。
- 使用JavaScript语言和Node.js构建服务器端脚本，并使用HTML5呈现文档元素。
- 核心格式组是OOXML，它使套件与DOCX、XLSX和PPTX文件完全兼容，而其他格式则通过内部转换进行处理。
- 具有实时协同编辑、评论、在线聊天、版本历史记录、跟踪更改和文档比较等协作工具，并支持各种类型的共享权限，包括完全访问、仅查看、评论、审阅、填写表单和自定义筛选。
- 可以使用基于API通信或WOPI协议的集成应用程序在第三方环境中集成。
- 可以使用不同的方法在客户端的体系结构上进行部署，包括Windows和Linux服务器安装选项、Docker、Pod
## 1.2技术
- 编辑器的技术基础是HTML5 Canvas。
- 画布是一个包含不同绘图元素的容器，如线条、形状、图形和框架。HTML结构中的每个对象都是独立处理的，而画布结构的其余部分不受该特定对象的操作的影响。这有助于保持高精度的显示，使内容浏览器和操作系统不可知，并在查看、编辑或打印文档时提供平等的文档呈现。
## 1.3结构
- 服务体系结构在ONLYOFFICE文档部署模型的数据安全性、性能和灵活性方面发挥着至关重要的作用。
- ONLYOFFICE在用户浏览器中调用一个完整的文档编辑器应用程序，将大部分流程负载转移到客户端。
- 同时，服务器端只处理保存、传输文件更改和拼写检查等过程。
- 体系结构中的每个服务都可以单独托管在一个集群中，这还增加了容错能力，并允许根据环境构建自定义服务映射。
- ONLYOFFICE文档的服务架构如下：
![001architecture.png](001architecture.png)
- 根据内部测试结果，这样的架构设计使得一台32GB RAM的8核机器足以容纳1000个同时编辑的文档，假设每4秒对所有文档进行一次更改（1000个连接每秒250次更改）。
- 在这里，在1小时的测试中，每60秒关闭9-10%的连接，并将文档发送到服务器以进行转换和构建（即90-100个关闭的连接）。正在创建相同数量的新连接。在测试期间，发送了5931份文件用于改造和建造。
## 1.4编辑功能
### 1.4.1Word
- 允许使用一组文本和段落格式设置功能、对象、文本样式、页面布局和引用工具来处理大多数流行格式的文档。
- 允许创建高度兼容的文本文档，用于所有流行的用途：文档、业务沟通、研究等。
- 使用文本内容的功能包括字体调整工具（大小、字体样式、颜色等）、编号和项目符号列表、段落对齐设置、缩进和间距、样式复制和清除、文本样式预设，以及基本和高级文本调整设置。
- 自定义和放置选项支持各种核心对象，包括表格、图像、图表、自动形状、超链接、页眉和页脚、日期和时间、文本框和文本艺术、公式、文本符号、首字母和内容控件。
- 页面上的大多数对象类型都可以根据偏好进行包装和对齐，与占位符和标题一起使用，并进行分组。
- 页面布局可以使用页边距、页面方向设置、按列划分文本、添加分页符、分栏符和分节符以及插入行号进行配置。
- 可用的专业页面布局元素包括目录和图表、脚注和尾注、超链接和交叉引用、书签。
### 1.4.2Excel
- 将计算、过滤和组织数据所需的所有工具，以及为工作表和表格设置样式所需的协作工具与有效团队合作和共享访问所需的工具相结合。
- 具有450多个公式，具有简单的导航、文本和单元格格式和样式设置工具，能够插入图表、公式、图像、文本框、形状、迷你图、超链接和符号等对象。
- 用户能够打开、管理和创建数据透视表，以显示大型电子表格的紧凑数据摘要，并能够自定义筛选器、行和列、管理和分组值。
- 有多种处理数据的工具可用：过滤、排序、数据验证、重复删除、单元格分组和文本到列的转换。
- 特殊保护功能包括电子表格加密、工作簿和工作表保护、允许编辑某些区域的功能、单元格锁定以及隐藏公式的功能。
- 使用显示设置、打印布局、自定义范围选择和其他参数，可以在打印前预览电子表格。
### 1.4.3ppt
- 允许在经典的幻灯片显示模式下创建演示文稿和运行幻灯片，并在演示者模式下在两个共享屏幕上运行。
- 该编辑器具有文档编辑器中可用的所有文本格式和样式工具，并支持ONLYOFFICE文档中用于创建幻灯片内容的所有类型的对象。
- 为了改进演示设计并提供更引人入胜的幻灯片，可以添加幻灯片过渡并为所有幻灯片对象使用动画效果，分别从过渡库和动画库中选择样式。

### 1.4.4表格创建和填写
- 提供了内置的表单创建功能。电子表单通过准备和使用文档模板来帮助文档创建过程自动化。
- 可以在线或本地创建、编辑和共同编辑具有可填充字段的文档，并共享这些字段以进行填充，这消除了成本并减少了从头开始创建文档所花费的时间。
- 创建文档模板（表单）的格式为DOCXF。它允许插入可填充字段并在其中定义各种参数，包括布局、键、占位符、提示文本和字段类型特定的参数。
- 可用的字段类型有：
  - 文本字段；
  - 组合框；
  - 下拉列表；
  - 复选框；
  - 单选按钮；
  - 图像。
- 为了共享表格以供填写，使用了OFORM格式。该格式不允许编辑正文和文档布局，也不允许添加和自定义表单字段，但允许填充它们以创建最终文档。

### 1.4.5PDF和电子书阅读和转换
- 内置了文档查看器，使PDF和电子书格式的工作更加轻松。
- 它具有通过页面预览轻松导航文档内容的功能。还可以将PDF转换为可编辑的DOCX文件，并将支持的格式转换为PDF和PDF/A。
- 使用转换，可以将以DOCXF格式创建的ONLYOFFICE表单转换为PDF文件。

### 1.4.6支持的电子文件格式
支持以下类型的格式用于查看和编辑：

|  | 查看 | 编辑 | 下载 |
| :------ | :------ | :------ | :------ |
| 文本文档 | DOC, DOCX, DOTX, FB2, ODT, OTT, RTF, TXT, PDF, PDF/A, HTML, EPUB, XPS, DjVu, XML, DOCXF, OFORM | DOC, DOCX, DOTX, FB2, ODT, OTT, RTF, TXT, HTML, EPUB, XML, DOCXF, OFORM | DOCX, DOTX, FB2, ODT, OTT, RTF, TXT, PDF, PDF/A, HTML, EPUB, DOCXF, OFORM |
| 电子表格 | XLS, XLSX, XLTX, ODS,OTS, CSV | XLS, XLSX, XLTX, ODS,OTS, CSV|XLSX, XLTX, ODS,OTS, CSV, PDF,PDF/A |
| 演讲 | PPT, PPTX, POTX, ODP, OTP, PPSX | PPT, PPTX, POTX, ODP, OTP|PPTX, POTX, ODP, OTP, PDF, PDF/A, PNG, JPG |

### 1.4.7第三方插件和宏
- 功能可以使用第三方插件进行扩展，这些插件提供额外功能或将外部服务连接到套件，并作为迷你应用程序集成在界面中。
应用程序目录中当前可用的插件包括：
- 还支持用于自动执行文本文档和电子表格中任务的宏。ONLYOFFICE中的宏基于JavaScript语法和Document Builder API方法，使它们易于使用、安全和跨平台。

## 1.5协作功能
- 允许在集成平台内的任意数量的用户之间协作编辑文档。
- 由于ONLYOFFICE Docs的架构意味着编辑器的客户端性能，在同一服务器上处理同一文档时，每个用户都可以独立于所有其他用户激活任何功能或选择任何模式。
- 这显著改进了许多方面的工作，包括使用“撤消”和“重做”命令独立恢复操作。这种方法还最小化了服务器负载，使设置变得轻量级。
- 协作功能包括：
  - 灵活的共享权限：仅查看、完全访问、审阅、注释、填写表单、自定义筛选器。
  - 两种协同编辑模式：快速（实时）和严格（段落锁定）
  - 跟踪变化；
  - 评论；
  - 在评论中提及用户；
  - 内置聊天；
  - 版本和修订控制（版本历史）。
- 通过独立使用所有功能和协作模式，来自不同设备和客户端（包括网络套件、桌面和移动应用程序）的大量用户之间可以进行协作。
- 尽管大多数操作都是在ONLYOFFICE文档（文档服务器）中执行的，但有些功能在集成中依赖于与用户管理系统的通信。版本历史记录和提及等功能的可用性目前在每个集成中都有所不同。

## 1.6数据安全
- 在设计上是安全的，这得益于自托管的部署模型。此外，在任何基础结构中存储和编辑文件时，它都提供了多种保护数据的功能：
  - 为了保护流量，ONLYOFFICE使用HTTPS运行，而文档编辑连接则使用JWT进行额外保护。
  - 共享中提供灵活的权限：使用完全访问、只读、评论、审阅或填写表单权限，允许或不允许修改电子表格中的筛选器，如果您愿意，还可以限制下载、复制和打印。
  - 您还可以应用水印，以避免未经授权重新分发您的内容。
  - 文件加密可用于文件和电子表格，包括保护整个工作簿和电子表格中的单独表格。
- ONLYOFFICE具有内置功能，可帮助企业遵守HIPAA和欧盟隐私法规。

## 1.7接口定制
可以自定义ONLYOFFICE文档的界面，以增强使用套件时的体验。

| 选项 | 说明 |
| :------ | :------ |
| 界面主题 | 可以将界面主题分别设置为`暗`、`亮`和`经典`灯光。在某些集成中，可以在管理级别控制主题设置。 |
| 界面和文档缩放 | 编辑器支持100%、125%、150%、175%和200%的自动缩放。 手动文档缩放选项的范围从50%到200%。 |
| 工具栏、状态栏和标尺 | 可以隐藏主工具栏、状态栏和标尺以展开工作区域。 |
| 工具栏布局* | 在设置中，可以在完整和紧凑的工具栏布局之间切换，并更改选项卡的颜色。 |
| 附加选项（适用于开发人员） | 脚本级配置允许调整按钮和命令、公司和联系人信息、徽标等的显示。 |
该功能目前在一些集成中可用，包括Nextcloud和ownCloud。

# 2.整合机制
## 2.1通过基于API的连接器进行集成
- 基于API的集成是将ONLYOFFICE文档连接到文件存储和共享环境的一种随意方式，包括同步和共享服务、内容管理系统（CMS）和学习管理系统（LMS）。目前大多数可用的连接器都是基于API的。
- 开放式API允许构建应用程序，以集成ONLYOFFICE独有的任何功能，或将自定义重新构建功能集成到连接的存储中，为用户提供完整的体验。
- 基于API的集成方案
![002integration.png](002integration.png)
- ONLYOFFICE文档（文档服务器）与第三方服务的集成需要一个额外的应用程序，该应用程序将数据转换为兼容的格式。此角色由连接器扮演。ONLYOFFICE团队创建自己的官方连接器，并协助合作伙伴和第三方开发人员创建此类应用程序。
- 集成应用程序结构
![003structure.png](003structure.png)
- 通过基于API的集成提供的功能*：

| 功能      | 说明                                                                                                                       |
|:--------|:-------------------------------------------------------------------------------------------------------------------------|
| 支持格式    | 用于查看和编辑：DOCX、XLSX、PPTX、PPSX、OFORM、DOCXF 仅供查看：PDF、DJVU、TXT、CSV、ODT、ODS、ODP、DOC、XLS、PPT、PPS、EPUB、RTF、HTML、HTM、MHT、XPS      |
| 协作模式    | 在实时和段落锁定协同编辑模式之间切换。                                                                                                      |
| 自定义     | 为编辑器设置界面语言和主题、隐藏聊天菜单按钮、更改“关于”部分中的信息、界面自定义，如调整标题和工具栏、品牌、连接插件                                                              |
| 基本功能    | 查看、编辑、共同编辑、移动查看和编辑、简化查看（嵌入式）                                                                                             |
| 其他操作：方法 | 以所选格式下载文件、将文件标记为收藏夹、显示带有消息的工具提示                                                                                          |
| 其他操作：事件 | 关闭编辑器、打开文件位置、将文件从查看模式切换到编辑模式、重命名文档、管理文档访问权限、打开版本历史记录、插入存储中的图像、邮件合并、与存储中的文档进行比较、在书签位置获取打开文件的链接、以所需格式保存文件、在评论中提及其他用户、创建新文档 |
| 安全      | IP地址白名单、使用JWT验证请求和防止未经授权访问                                                                                               |
| 文档权限    | 查看、编辑、审查（文本文件）、评论、填写表格、修改内容控件（文本文档）、修改过滤器（电子表格）、复制到剪贴板、下载、打印、重命名                                                         |
| 局限性     | 编辑器中提供的所有功能都可以集成。                                                                                                        |

# 3.部署模型
## 3.1专用服务器部署
- ONLYOFFICE Docs有多种软件包可供在公司周边部署，包括Linux服务器（包括ARM64服务器）、Windows服务器、Docker版本和Fedora的Podman版本。
- 自托管套件保证了对您的数据的完全控制，并且最终在设计上是安全的，您的实例中没有任何信息被监控或存储在第三方云中。










