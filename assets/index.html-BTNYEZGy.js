import{_ as i,c as t,a as s,o as l}from"./app-CiQOVv9k.js";const a="/assets/001architecture-CPJwhoX6.png",n="/assets/002integration-C4tnVquc.png",d="/assets/003structure-Cke6mgOg.png",r="/assets/004page-JDcSG46t.png",h="/assets/005port-DGE1Q1ze.png",c="/assets/006example-BhxHb9D2.png",o="/assets/007example-page-xt-oqloh.png",p={};function k(y,e){return l(),t("div",null,e[0]||(e[0]=[s('<h2 id="描述" tabindex="-1"><a class="header-anchor" href="#描述"><span>描述</span></a></h2><ul><li>OnlyOffice是一个多端协同的 Office 办公套件，结合了文本文档、电子表格、演示文稿和表单的编辑器。</li><li>后端：JavaScript语言和Node.js构建服务器端脚本</li><li>前端：使用HTML5呈现文档元素。 <ul><li>编辑器的技术基础是HTML5 Canvas。画布是一个包含不同绘图元素的容器，如线条、形状、图形和框架。HTML结构中的每个对象都是独立处理的，而画布结构的其余部分不受该特定对象的操作的影响。这有助于保持高精度的显示，使内容浏览器和操作系统不可知，并在查看、编辑或打印文档时提供平等的文档呈现。</li></ul></li><li>核心格式组是OOXML，它使套件与DOCX、XLSX和PPTX文件完全兼容，而其他格式则通过内部转换进行处理。</li><li>具有<code>实时协同编辑</code>、<code>评论</code>、<code>在线聊天</code>、<code>版本历史记录</code>、<code>跟踪更改</code>和<code>文档比较</code>等协作工具，并支持各种类型的共享权限，包括<code>完全访问</code>、<code>仅查看</code>、<code>评论</code>、<code>审阅</code>、<code>填写表单</code>和<code>自定义筛选</code>。</li><li>可以使用基于API通信或WOPI协议的集成应用程序在第三方环境中集成。</li><li>可以使用不同的方法在客户端的体系结构上进行部署，包括Windows和Linux服务器安装选项、Docker、Pod</li></ul><h2 id="结构" tabindex="-1"><a class="header-anchor" href="#结构"><span>结构</span></a></h2><ul><li>服务体系结构在OnlyOffice文档部署模型的<code>数据安全性</code>、<code>性能</code>和<code>灵活性</code>方面发挥着至关重要的作用。</li><li>客户端：浏览器中调用一个完整的文档编辑器应用程序，将大部分流程负载转移到客户端</li><li>服务器端只处理<code>保存</code>、<code>传输文件更改</code>和<code>拼写检查</code>等过程。</li><li>体系结构中的每个服务都可以单独托管在一个集群中，这还增加了容错能力，并允许根据环境构建自定义服务映射。</li><li>服务架构如下： <img src="'+a+'" alt="001architecture.png"></li><li>这样的架构设计使得一台<code>32GB RAM的8核</code>机器足以容纳<code>1000个同时编辑的文档</code>，假设每4秒对所有文档进行一次更改（1000个连接每秒250次更改）。</li></ul><h2 id="编辑功能" tabindex="-1"><a class="header-anchor" href="#编辑功能"><span>编辑功能</span></a></h2><h3 id="支持的电子文件格式" tabindex="-1"><a class="header-anchor" href="#支持的电子文件格式"><span>支持的电子文件格式</span></a></h3><p>支持以下类型的格式用于查看和编辑：</p><table><thead><tr><th style="text-align:left;"></th><th style="text-align:left;">查看</th><th style="text-align:left;">编辑</th><th style="text-align:left;">下载</th></tr></thead><tbody><tr><td style="text-align:left;">文本文档</td><td style="text-align:left;">DOC, DOCX, DOTX, FB2, ODT, OTT, RTF, TXT, PDF, PDF/A, HTML, EPUB, XPS, DjVu, XML, DOCXF, OFORM</td><td style="text-align:left;">DOC, DOCX, DOTX, FB2, ODT, OTT, RTF, TXT, HTML, EPUB, XML, DOCXF, OFORM</td><td style="text-align:left;">DOCX, DOTX, FB2, ODT, OTT, RTF, TXT, PDF, PDF/A, HTML, EPUB, DOCXF, OFORM</td></tr><tr><td style="text-align:left;">电子表格</td><td style="text-align:left;">XLS, XLSX, XLTX, ODS,OTS, CSV</td><td style="text-align:left;">XLS, XLSX, XLTX, ODS,OTS, CSV</td><td style="text-align:left;">XLSX, XLTX, ODS,OTS, CSV, PDF,PDF/A</td></tr><tr><td style="text-align:left;">演讲</td><td style="text-align:left;">PPT, PPTX, POTX, ODP, OTP, PPSX</td><td style="text-align:left;">PPT, PPTX, POTX, ODP, OTP</td><td style="text-align:left;">PPTX, POTX, ODP, OTP, PDF, PDF/A, PNG, JPG</td></tr></tbody></table><h2 id="协作功能" tabindex="-1"><a class="header-anchor" href="#协作功能"><span>协作功能</span></a></h2><ul><li>允许在集成平台内的任意数量的用户之间协作编辑文档。</li><li>由于OnlyOffice Docs的架构意味着编辑器的客户端性能，在同一服务器上处理同一文档时，每个用户都可以独立于所有其他用户激活任何功能或选择任何模式。</li><li>这显著改进了许多方面的工作，包括使用<code>撤消</code>和<code>重做</code>命令独立恢复操作。这种方法还最小化了服务器负载，使设置变得轻量级。</li><li>协作功能包括： <ul><li>灵活的共享权限：仅查看、完全访问、审阅、注释、填写表单、自定义筛选器。</li><li>两种协同编辑模式：快速（实时）和严格（段落锁定）</li><li>跟踪变化；</li><li>评论；</li><li>在评论中提及用户；</li><li>内置聊天；</li><li>版本和修订控制（版本历史）。</li></ul></li><li>通过独立使用所有功能和协作模式，来自不同设备和客户端（包括网络套件、桌面和移动应用程序）的大量用户之间可以进行协作。</li><li>尽管大多数操作都是在OnlyOffice文档（文档服务器）中执行的，但有些功能在集成中依赖于与用户管理系统的通信。版本历史记录和提及等功能的可用性目前在每个集成中都有所不同。</li></ul><h2 id="数据安全" tabindex="-1"><a class="header-anchor" href="#数据安全"><span>数据安全</span></a></h2><ul><li>在设计上是安全的，这得益于自托管的部署模型。此外，在任何基础结构中存储和编辑文件时，它都提供了多种保护数据的功能： <ul><li>为了保护流量，OnlyOffice使用HTTPS运行，而文档编辑连接则使用JWT进行额外保护。</li><li>共享中提供灵活的权限：使用完全访问、只读、评论、审阅或填写表单权限，允许或不允许修改电子表格中的筛选器，如果您愿意，还可以限制下载、复制和打印。</li><li>您还可以应用水印，以避免未经授权重新分发您的内容。</li><li>文件加密可用于文件和电子表格，包括保护整个工作簿和电子表格中的单独表格。</li></ul></li><li>OnlyOffice具有内置功能，可帮助企业遵守HIPAA和欧盟隐私法规。</li></ul><h2 id="接口定制" tabindex="-1"><a class="header-anchor" href="#接口定制"><span>接口定制</span></a></h2><p>可以自定义OnlyOffice文档的界面，以增强使用套件时的体验。</p><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">界面主题</td><td style="text-align:left;">可以将界面主题分别设置为<code>暗</code>、<code>亮</code>和<code>经典</code>灯光。在某些集成中，可以在管理级别控制主题设置。</td></tr><tr><td style="text-align:left;">界面和文档缩放</td><td style="text-align:left;">编辑器支持100%、125%、150%、175%和200%的自动缩放。 手动文档缩放选项的范围从50%到200%。</td></tr><tr><td style="text-align:left;">工具栏、状态栏和标尺</td><td style="text-align:left;">可以隐藏主工具栏、状态栏和标尺以展开工作区域。</td></tr><tr><td style="text-align:left;">工具栏布局*</td><td style="text-align:left;">在设置中，可以在完整和紧凑的工具栏布局之间切换，并更改选项卡的颜色。</td></tr><tr><td style="text-align:left;">附加选项（适用于开发人员）</td><td style="text-align:left;">脚本级配置允许调整按钮和命令、公司和联系人信息、徽标等的显示。</td></tr></tbody></table><h1 id="整合机制" tabindex="-1"><a class="header-anchor" href="#整合机制"><span>整合机制</span></a></h1><h2 id="通过基于api的连接器进行集成" tabindex="-1"><a class="header-anchor" href="#通过基于api的连接器进行集成"><span>通过基于API的连接器进行集成</span></a></h2><ul><li>基于API的集成是将OnlyOffice文档连接到文件存储和共享环境的一种随意方式，包括同步和共享服务、内容管理系统（CMS）和学习管理系统（LMS）。目前大多数可用的连接器都是基于API的。</li><li>开放式API允许构建应用程序，以集成OnlyOffice独有的任何功能，或将自定义重新构建功能集成到连接的存储中，为用户提供完整的体验。</li><li>基于API的集成方案 <img src="'+n+'" alt="002integration.png"></li><li>OnlyOffice文档（文档服务器）与第三方服务的集成需要一个额外的应用程序，该应用程序将数据转换为兼容的格式。此角色由连接器扮演。OnlyOffice团队创建自己的官方连接器，并协助合作伙伴和第三方开发人员创建此类应用程序。</li><li>集成应用程序结构 <img src="'+d+`" alt="003structure.png"></li><li>通过基于API的集成提供的功能*：</li></ul><table><thead><tr><th style="text-align:left;">功能</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;">支持格式</td><td style="text-align:left;">用于查看和编辑：DOCX、XLSX、PPTX、PPSX、OFORM、DOCXF 仅供查看：PDF、DJVU、TXT、CSV、ODT、ODS、ODP、DOC、XLS、PPT、PPS、EPUB、RTF、HTML、HTM、MHT、XPS</td></tr><tr><td style="text-align:left;">协作模式</td><td style="text-align:left;">在实时和段落锁定协同编辑模式之间切换。</td></tr><tr><td style="text-align:left;">自定义</td><td style="text-align:left;">为编辑器设置界面语言和主题、隐藏聊天菜单按钮、更改“关于”部分中的信息、界面自定义，如调整标题和工具栏、品牌、连接插件</td></tr><tr><td style="text-align:left;">基本功能</td><td style="text-align:left;">查看、编辑、共同编辑、移动查看和编辑、简化查看（嵌入式）</td></tr><tr><td style="text-align:left;">其他操作：方法</td><td style="text-align:left;">以所选格式下载文件、将文件标记为收藏夹、显示带有消息的工具提示</td></tr><tr><td style="text-align:left;">其他操作：事件</td><td style="text-align:left;">关闭编辑器、打开文件位置、将文件从查看模式切换到编辑模式、重命名文档、管理文档访问权限、打开版本历史记录、插入存储中的图像、邮件合并、与存储中的文档进行比较、在书签位置获取打开文件的链接、以所需格式保存文件、在评论中提及其他用户、创建新文档</td></tr><tr><td style="text-align:left;">安全</td><td style="text-align:left;">IP地址白名单、使用JWT验证请求和防止未经授权访问</td></tr><tr><td style="text-align:left;">文档权限</td><td style="text-align:left;">查看、编辑、审查（文本文件）、评论、填写表格、修改内容控件（文本文档）、修改过滤器（电子表格）、复制到剪贴板、下载、打印、重命名</td></tr><tr><td style="text-align:left;">局限性</td><td style="text-align:left;">编辑器中提供的所有功能都可以集成。</td></tr></tbody></table><h1 id="实战开发" tabindex="-1"><a class="header-anchor" href="#实战开发"><span>实战开发</span></a></h1><h2 id="onlyoffice社区版" tabindex="-1"><a class="header-anchor" href="#onlyoffice社区版"><span>OnlyOffice社区版</span></a></h2><ul><li>文档服务器：<code>Document Server</code></li><li>社区服务器：<code>Community Server</code></li><li>邮件服务器：<code>Mail Server</code></li></ul><h2 id="docker部署文档服务器" tabindex="-1"><a class="header-anchor" href="#docker部署文档服务器"><span>docker部署文档服务器</span></a></h2><ul><li>【<a href="https://helpcenter.onlyoffice.com/installation/docs-community-install-docker.aspx" target="_blank" rel="noopener noreferrer">官网教程</a>】</li><li>1、拉取镜像：</li></ul><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>docker pull onlyoffice/documentserver</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>2、启动容器：</li></ul><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -itd</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 9000:80</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --restart=always</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> D:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\w</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">orkNew</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">tudy</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nlyoffice</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\D</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ocumentServer</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\l</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ogs:/var/log/onlyoffice</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 日志数据</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> D:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\w</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">orkNew</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">tudy</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nlyoffice</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\D</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ocumentServer</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\d</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ata:/var/www/onlyoffice/Data</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # ssl证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> D:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\w</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">orkNew</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">tudy</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nlyoffice</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\D</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ocumentServer</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\l</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ib:/var/lib/onlyoffice</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 文件缓存数据</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> D:</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\w</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">orkNew</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\s</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">tudy</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nlyoffice</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\D</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ocumentServer</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\d</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">b:/var/lib/postgresql</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 数据库</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-e</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> JWT_SECRET=my_jwt_secret</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> #  JWT密钥，不设置会自动生成，也可以关闭【-e JWT_ENABLED=false】</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">onlyoffice/documentserver</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 镜像名</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>进入容器：<code>docker exec -it ID /bin/bash</code></li><li>启动所有的内置服务：<code>supervisorctl restart all</code></li><li>退出容器：<code>exit</code></li><li>访问：<code>http://IP:9000/</code><img src="`+r+'" alt="004page.png"></li><li>页面包括 <ul><li><a href="./onlyoffice/https://api.onlyoffice.com/editors/basic">开发文档</a></li><li>查看密钥：</li></ul><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>docker exec ID /var/www/onlyoffice/documentserver/npm/json -f /etc/onlyoffice/documentserver/local.json &#39;services.CoAuthoring.secret.session.string&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>启动example服务：</li></ul><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>docker exec ID sudo supervisorctl start ds:example</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>设置example服务自动启动：</li></ul><div class="language- line-numbers-mode" data-ext="" data-title=""><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>docker exec ID sudo sed &#39;s,autostart=false,autostart=true,&#39; -i /etc/supervisor/conf.d/ds-example.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li>服务列表（都是通过pkg打包成可执行文件，摆脱node环境的依赖） <ul><li><code>ds:converter</code>：转换器</li><li><code>ds:docservice</code>：文档服务</li><li><code>ds:example</code>：例子</li><li><code>ds:metrics</code></li></ul></li><li>服务占用端口： <ul><li><code>nginx</code>：<code>80</code></li><li><code>rabbitmq</code>：<code>5672</code>、<code>25672</code>、<code>4369</code></li><li><code>postgres</code>：<code>5432</code></li><li><code>docservice</code>: <code>8000</code></li><li><code>example</code>：<code>3000</code><img src="'+h+'" alt="005port.png"></li></ul></li></ul><h2 id="example测试" tabindex="-1"><a class="header-anchor" href="#example测试"><span>example测试</span></a></h2><p><img src="'+c+'" alt="006example.png"><img src="'+o+'" alt="007example-page.png"></p>',30)]))}const f=i(p,[["render",k],["__file","index.html.vue"]]),u=JSON.parse('{"path":"/article/3mhob01y/","title":"OnlyOffice介绍及docker部署Document Server","lang":"zh-CN","frontmatter":{"title":"OnlyOffice介绍及docker部署Document Server","createTime":"2023/11/02 13:27:26","tags":["OnlyOffice","OnlyOffice Docker部署Document Server"],"permalink":"/article/3mhob01y/"},"headers":[],"readingTime":{"minutes":8.25,"words":2474},"git":{"updatedTime":1737255104000,"contributors":[{"name":"jqh","username":"jqh","email":"1789622669@qq.com","commits":2,"avatar":"https://gravatar.com/avatar/e51d6bd9179d8251507631920dbee86805db2675024268e3d9894ba170e9c314?d=retro"}]},"filePathRelative":"2024/其他/onlyoffice.md","categoryList":[{"id":"07811d","sort":10001,"name":"2024"},{"id":"7587db","sort":10002,"name":"其他"}],"bulletin":false}');export{f as comp,u as data};
